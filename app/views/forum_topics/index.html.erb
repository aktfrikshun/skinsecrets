<div class="bg-gradient-to-br from-amber-50 to-warm-50 py-20">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
      <div class="mb-6 md:mb-0">
        <h1 class="font-playfair text-4xl md:text-5xl font-bold text-gray-900 mb-4">Community Forum</h1>
        <p class="text-lg text-gray-600">Connect with other clients, share experiences, and get advice from our community.</p>
      </div>
      <div class="flex gap-3">
        <% if logged_in? %>
          <%= link_to new_forum_topic_path, class: "bg-gradient-to-r from-amber-500 to-amber-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-amber-600 hover:to-amber-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1" do %>
            <i class="fas fa-plus mr-2"></i>New Topic
          <% end %>
        <% end %>
        <% if logged_in? && @current_user&.email == 'admin@skinsecretsnc.com' %>
          <%= button_to generate_ai_topic_forum_topic_path(ForumTopic.first || 1), method: :post, class: "bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-blue-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1", form: { style: "display: inline;" } do %>
            <i class="fas fa-robot mr-2"></i>Generate AI Topic
          <% end %>
        <% end %>
      </div>
    </div>
    
    <% if @forum_topics.any? %>
      <div class="space-y-6">
        <% @forum_topics.each do |topic| %>
          <div class="bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 border border-gray-100">
            <div class="p-8">
              <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-center">
                <div class="lg:col-span-2">
                  <h3 class="font-playfair text-2xl font-bold text-gray-900 mb-3">
                    <%= link_to topic.title, forum_topic_path(topic), class: "text-gray-900 hover:text-amber-600 transition-colors duration-300" %>
                  </h3>
                  <div class="text-gray-600 mb-4 prose prose-sm max-w-none">
                    <p class="leading-relaxed text-gray-600"><%= topic.excerpt %></p>
                  </div>
                  <div class="flex flex-wrap items-center text-gray-500 text-sm space-x-6">
                    <span class="flex items-center">
                      <i class="fas fa-user mr-2 text-amber-600"></i><%= topic.user.full_name %>
                      <% if topic.user.email == 'ai@skinsecrets.com' %>
                        <span class="ml-2 px-2 py-1 bg-gradient-to-r from-purple-500 to-blue-500 text-white text-xs rounded-full font-medium">
                          <i class="fas fa-robot mr-1"></i>AI
                        </span>
                      <% end %>
                      <% if topic.user.email == 'ai@skinsecrets.com' || topic.user.email == 'admin@skinsecretsnc.com' %>
                        <span class="ml-2 px-2 py-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs rounded-full font-medium">
                          <i class="fab fa-facebook mr-1"></i>Facebook
                        </span>
                      <% end %>
                    </span>
                    <span class="flex items-center">
                      <i class="fas fa-calendar mr-2 text-amber-600"></i><%= topic.created_at.strftime("%B %d, %Y") %>
                    </span>
                    <span class="flex items-center">
                      <i class="fas fa-comments mr-2 text-amber-600"></i><%= topic.post_count %> posts
                    </span>
                  </div>
                </div>
                <div class="lg:col-span-1 text-center lg:text-right">
                  <div class="text-gray-500 text-sm mb-4">
                    <div class="font-medium mb-1">Last activity:</div>
                    <div><%= topic.last_activity.strftime("%B %d, %Y") %></div>
                  </div>
                  <% if logged_in? && @current_user&.email == 'admin@skinsecretsnc.com' %>
                    <div class="mt-4">
                      <% if topic.posted_to_facebook? %>
                        <div class="text-center">
                          <div class="bg-green-100 text-green-800 px-4 py-2 rounded-lg text-sm font-medium mb-2">
                            <i class="fab fa-facebook mr-2"></i>Posted to FB
                          </div>
                          <div class="text-xs text-gray-500">
                            <%= topic.facebook_posted_at.strftime("%m/%d %H:%M") %>
                          </div>
                          <% if topic.can_post_to_facebook? %>
                            <%= button_to post_to_facebook_forum_topic_path(topic), method: :post, 
                                class: "bg-gradient-to-r from-orange-500 to-orange-600 text-white px-3 py-1 rounded text-xs font-semibold hover:from-orange-600 hover:to-orange-700 transition-all duration-300 mt-2",
                                form: { style: "display: inline;" },
                                data: { 
                                  confirm: "Re-post this topic to Facebook?",
                                  turbo_method: :post
                                } do %>
                              <i class="fas fa-redo mr-1"></i>Re-post
                            <% end %>
                          <% end %>
                        </div>
                      <% else %>
                        <%= button_to post_to_facebook_forum_topic_path(topic), method: :post, 
                            class: "bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-lg font-semibold text-sm hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",
                            form: { style: "display: inline;" },
                            data: { 
                              confirm: "Post this topic to Facebook immediately?",
                              turbo_method: :post
                            } do %>
                          <i class="fab fa-facebook mr-2"></i>Post to FB
                        <% end %>
                      <% end %>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-center py-16">
        <div class="w-32 h-32 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-8">
          <i class="fas fa-comments text-amber-600 text-4xl"></i>
        </div>
        <h3 class="font-playfair text-3xl font-bold text-gray-900 mb-4">No Topics Yet</h3>
        <p class="text-lg text-gray-600 mb-8">Be the first to start a discussion in our community forum!</p>
        <% if logged_in? %>
          <%= link_to new_forum_topic_path, class: "bg-gradient-to-r from-amber-500 to-amber-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:from-amber-600 hover:to-amber-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1" do %>
            <i class="fas fa-plus mr-2"></i>Start First Topic
          <% end %>
        <% else %>
          <%= link_to signup_path, class: "bg-gradient-to-r from-amber-500 to-amber-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:from-amber-600 hover:to-amber-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1" do %>
            <i class="fas fa-user-plus mr-2"></i>Join to Participate
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>

<!-- Forum Guidelines -->
<div class="py-20 bg-white">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="bg-gray-50 rounded-2xl p-8 shadow-lg">
      <h4 class="text-amber-600 font-semibold text-xl mb-6 flex items-center">
        <i class="fas fa-info-circle mr-3"></i>Community Guidelines
      </h4>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
          <h6 class="font-semibold text-gray-900 mb-3">Be Respectful</h6>
          <ul class="text-gray-600 text-sm space-y-2">
            <li class="flex items-start">
              <i class="fas fa-check text-amber-600 mr-2 mt-1 text-xs"></i>
              Treat others with kindness and respect
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-amber-600 mr-2 mt-1 text-xs"></i>
              No personal attacks or harassment
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-amber-600 mr-2 mt-1 text-xs"></i>
              Keep discussions constructive
            </li>
          </ul>
        </div>
        <div>
          <h6 class="font-semibold text-gray-900 mb-3">Stay On Topic</h6>
          <ul class="text-gray-600 text-sm space-y-2">
            <li class="flex items-start">
              <i class="fas fa-check text-amber-600 mr-2 mt-1 text-xs"></i>
              Share skin care experiences and tips
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-amber-600 mr-2 mt-1 text-xs"></i>
              Ask questions about treatments
            </li>
            <li class="flex items-start">
              <i class="fas fa-check text-amber-600 mr-2 mt-1 text-xs"></i>
              Discuss beauty and wellness topics
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div> 